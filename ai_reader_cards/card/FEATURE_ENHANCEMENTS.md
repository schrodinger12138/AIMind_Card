# æ€ç»´å¯¼å›¾åŠŸèƒ½å¢å¼ºè¯´æ˜

## å·²å®ç°çš„åŠŸèƒ½

æ ¹æ® `MINDMAP_FEATURE_ANALYSIS.md` çš„åˆ†æï¼Œå·²æ·»åŠ ä»¥ä¸‹åŠŸèƒ½ï¼š

### 1. èŠ‚ç‚¹å½¢çŠ¶æ‰©å±• âœ…

**æ–‡ä»¶**: `ai_reader_cards/card/node_shapes.py`

**æ”¯æŒçš„å½¢çŠ¶**:
- `rectangle` - çŸ©å½¢ï¼ˆé»˜è®¤ï¼‰
- `rounded_rectangle` - åœ†è§’çŸ©å½¢
- `ellipse` - æ¤­åœ†
- `circle` - åœ†å½¢
- `diamond` - è±å½¢

**ä½¿ç”¨æ–¹æ³•**:
```python
from ai_reader_cards.card.node_shapes import NodeShapeFactory

# åˆ›å»ºå½¢çŠ¶
shape_item = NodeShapeFactory.create_shape(
    NodeShapeFactory.SHAPE_ROUNDED_RECTANGLE,
    QRectF(0, 0, 280, 180)
)
```

### 2. èŠ‚ç‚¹å›¾æ ‡æ”¯æŒ âœ…

**æ–‡ä»¶**: `ai_reader_cards/card/node_icons.py`

**å›¾æ ‡åˆ†ç±»**:
- `business` - å•†åŠ¡å›¾æ ‡ï¼ˆğŸ’¼ğŸ“ŠğŸ’°ğŸ¯ğŸ†ğŸ’¡ï¼‰
- `education` - æ•™è‚²å›¾æ ‡ï¼ˆğŸ“šğŸ“ğŸ«âœï¸ğŸ““ğŸ”¬ï¼‰
- `tools` - å·¥å…·å›¾æ ‡ï¼ˆğŸ”§ğŸ”¨ğŸª›âš™ï¸ğŸ§°ï¼‰
- `communication` - é€šä¿¡å›¾æ ‡ï¼ˆğŸ“ğŸ“§ğŸ’¬ğŸ’­ğŸ“¢ï¼‰
- `time` - æ—¶é—´å›¾æ ‡ï¼ˆğŸ•ğŸ“…â°â±ï¸ï¼‰
- `status` - çŠ¶æ€å›¾æ ‡ï¼ˆâœ…âŒâš ï¸â„¹ï¸â­â¤ï¸ï¼‰
- `location` - ä½ç½®å›¾æ ‡ï¼ˆğŸ“ğŸ—ºï¸ğŸŒğŸ¢ï¼‰
- `food` - é£Ÿç‰©å›¾æ ‡ï¼ˆğŸâ˜•ğŸ•ğŸ‚ï¼‰
- `travel` - æ—…è¡Œå›¾æ ‡ï¼ˆğŸš—âœˆï¸ğŸš‚ğŸš¢ï¼‰
- `medical` - åŒ»ç–—å›¾æ ‡ï¼ˆğŸ¥ğŸ’ŠğŸ’“ğŸ©ºï¼‰

**ä½¿ç”¨æ–¹æ³•**:
```python
from ai_reader_cards.card.node_icons import IconManager

# è·å–å›¾æ ‡
icon_char = IconManager.get_icon('business', 'briefcase')  # è¿”å› 'ğŸ’¼'

# åˆ›å»ºå›¾æ ‡åƒç´ å›¾
pixmap = IconManager.create_icon_pixmap(icon_char, size=24)
```

### 3. èŠ‚ç‚¹æ ‡ç­¾æ”¯æŒ âœ…

**æ–‡ä»¶**: `ai_reader_cards/card/node_tags.py`

**åŠŸèƒ½**:
- å¤šæ ‡ç­¾æ”¯æŒ
- é¢„è®¾é¢œè‰²æ–¹æ¡ˆ
- åœ†è§’æ ‡ç­¾æ ·å¼

**ä½¿ç”¨æ–¹æ³•**:
```python
from ai_reader_cards.card.node_tags import TagManager

# åˆ›å»ºå•ä¸ªæ ‡ç­¾
tag = TagManager.create_tag("é‡è¦", color_index=0)

# åˆ›å»ºå¤šä¸ªæ ‡ç­¾
tags = TagManager.create_tags(
    ["é‡è¦", "å¾…åŠ", "å·²å®Œæˆ"],
    color_indices=[0, 1, 2]
)
```

### 4. æ•°æ®æ¨¡å‹æ›´æ–° âœ…

**æ–‡ä»¶**: `ai_reader_cards/card/madmap_based_models.py`

**æ–°å¢å±æ€§**:
- `shape` - èŠ‚ç‚¹å½¢çŠ¶
- `icon_category` - å›¾æ ‡åˆ†ç±»
- `icon_name` - å›¾æ ‡åç§°
- `tags` - æ ‡ç­¾åˆ—è¡¨
- `tag_colors` - æ ‡ç­¾é¢œè‰²ç´¢å¼•åˆ—è¡¨

æ‰€æœ‰æ–°å±æ€§å·²é›†æˆåˆ° `to_dict()` å’Œ `from_dict()` æ–¹æ³•ä¸­ï¼Œæ”¯æŒåºåˆ—åŒ–å’Œååºåˆ—åŒ–ã€‚

## å¾…é›†æˆåŠŸèƒ½

ä»¥ä¸‹åŠŸèƒ½å·²åˆ›å»ºåŸºç¡€æ¨¡å—ï¼Œä½†éœ€è¦åœ¨ `CardVisualNode` å’Œ `CardEditDialog` ä¸­é›†æˆï¼š

### 1. åœ¨ CardVisualNode ä¸­é›†æˆå½¢çŠ¶

éœ€è¦åœ¨ `setup_style()` æ–¹æ³•ä¸­ä½¿ç”¨ `NodeShapeFactory` åˆ›å»ºå½¢çŠ¶ï¼Œè€Œä¸æ˜¯ç›´æ¥ä½¿ç”¨ `QGraphicsRectItem`ã€‚

### 2. åœ¨ CardVisualNode ä¸­é›†æˆå›¾æ ‡

éœ€è¦åœ¨èŠ‚ç‚¹ä¸Šæ˜¾ç¤ºå›¾æ ‡ï¼ˆé€šå¸¸åœ¨æ ‡é¢˜æ—è¾¹ï¼‰ã€‚

### 3. åœ¨ CardVisualNode ä¸­é›†æˆæ ‡ç­¾

éœ€è¦åœ¨èŠ‚ç‚¹åº•éƒ¨æˆ–å³ä¾§æ˜¾ç¤ºæ ‡ç­¾åˆ—è¡¨ã€‚

### 4. æ›´æ–° CardEditDialog

éœ€è¦åœ¨ç¼–è¾‘å¯¹è¯æ¡†ä¸­æ·»åŠ ï¼š
- å½¢çŠ¶é€‰æ‹©å™¨
- å›¾æ ‡é€‰æ‹©å™¨
- æ ‡ç­¾ç¼–è¾‘å™¨

## ä¸‹ä¸€æ­¥å·¥ä½œ

1. **é›†æˆåˆ° CardVisualNode**:
   - ä¿®æ”¹ `setup_style()` ä½¿ç”¨ `NodeShapeFactory`
   - æ·»åŠ å›¾æ ‡æ˜¾ç¤ºé€»è¾‘
   - æ·»åŠ æ ‡ç­¾æ˜¾ç¤ºé€»è¾‘

2. **æ›´æ–°ç¼–è¾‘å¯¹è¯æ¡†**:
   - æ·»åŠ å½¢çŠ¶é€‰æ‹©ä¸‹æ‹‰æ¡†
   - æ·»åŠ å›¾æ ‡é€‰æ‹©å™¨ï¼ˆåˆ†ç±» + å›¾æ ‡åˆ—è¡¨ï¼‰
   - æ·»åŠ æ ‡ç­¾ç¼–è¾‘å™¨ï¼ˆæ·»åŠ /åˆ é™¤æ ‡ç­¾ï¼‰

3. **å®Œå–„å…³è”çº¿åŠŸèƒ½**:
   - æ·»åŠ åˆ›å»ºæ—¶çš„å®æ—¶é¢„è§ˆï¼ˆé¼ æ ‡ç§»åŠ¨æ—¶æ˜¾ç¤ºä¸´æ—¶è¿çº¿ï¼‰
   - æ·»åŠ æ§åˆ¶ç‚¹æ‹–æ‹½åŠŸèƒ½
   - æ·»åŠ å³é”®èœå•åˆ é™¤å…³è”çº¿

4. **å¢å¼ºè¿çº¿æ ·å¼**:
   - æ‰‹ç»˜é£æ ¼è¿çº¿
   - å½©è™¹çº¿æ¡
   - è¿çº¿æµåŠ¨åŠ¨ç”»

5. **å¢å¼ºèŠ‚ç‚¹æ“ä½œ**:
   - èŠ‚ç‚¹æ ¼å¼åˆ·
   - èŠ‚ç‚¹å¤–æ¡†
   - èŠ‚ç‚¹æ ‡è®°

## å‚è€ƒå®ç°

æ‰€æœ‰åŠŸèƒ½å‚è€ƒäº† `test/mind-map-main/simple-mind-map` é¡¹ç›®çš„å®ç°ï¼š
- å½¢çŠ¶ç³»ç»Ÿå‚è€ƒ `src/core/render/node/Shape.js`
- å›¾æ ‡ç³»ç»Ÿå‚è€ƒèŠ‚ç‚¹å†…å®¹åˆ›å»ºé€»è¾‘
- æ ‡ç­¾ç³»ç»Ÿå‚è€ƒ Simple Mind Map çš„æ ‡ç­¾åŠŸèƒ½

